import pandas as pd
from dataframe_cleaning import cleaning_data
from dfc2 import cleaning_data2
import re

df_tax_invoice = [['', '', '', '', '', '', '', '', '', 'CGST', '', 'SGST/ UGST', '', 'IGST'], ['', '', 'HSN Code/', '', '', '', 'Discount/', '', '', '', '', '', '', ''], ['S.No', 'Description of Goods', '', 'Qty', 'Unit', 'Rate', 'Total', 'Taxable value', '', '', '', '', '', ''], ['', '', 'SAC CODE', '', '', '', 'Abatement', '', 'Rate', 'Amount', 'Rate', 'Amount', 'Rate', 'Amount'], ['1', 'Diesel', '2201', '100', 'L', '95', '9500', '9500', '', '', '', '', '18.00', '1710.00'], ['2', 'Lubricant,Servo System HLP', '2710 19 80', '150', 'L', '116.64', '17496.00', '17496.00', '', '', '', '', '18.00', '3149.28'], ['3', 'PROPYLENE- REFINERY GRADE', '2902 90 90', '10', 'MT', '71,454.00', '714540', '714540.00', '', '', '', '', '5.00', '35727']]
df_service_with_activity = [['PAN No: AAHFS5211J', '', '', '', '', '', '', 'PAN No: AAHFS5211J', '', '', '', ''], ['', '', '', '', '', '', '', '', 'CGST', '', 'SGST/ UGST', 'IGST'], ['S.No', 'Description of Service', 'SAC CODE', 'Qty', 'Unit', 'Rate', 'Service Value', 'Taxable value', '', '', '', ''], ['', '', '', '', '', '', '', '', 'Rate', 'Amount', 'Rate', 'Amount\nRate \nAmount'], ['', 'Ground Civil work done for', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '787.5', '', '787.5'], ['1', 'Building A', '998343', '', '', '', '8750', '8750', '9.00', '', '9.00', ''], ['2', 'Repair work at site Portbander', '998343', '', '', '', '32060', '32060', '9.00', '2885.4', '9.00', '2885.4'], ['3', 'Labour Fees', '998343', '', '', '', '27600', '27600', '9.00', '2484', '9.00', '2484'], ['4', 'Excavation Service for Mines', '998343', '', '', '', '10920', '10920', '9.00', '982.8', '9.00', '982.8'], ['5', 'Loading services for Cement', '998343', '', '', '', '11000', '11000', '9.00', '990', '9.00', '990'], ['', '', '', '', '', 'Total Amount Before tax', '', '90330', '', '', 'Total Tax Amount', '16259.40']]
df_service_without_activity = [['', '', '', '', '', '', '', '', 'CGST', 'SGST/ UGST\nIGST'], ['S.No', 'Description of Service', 'SAC CODE', 'Qty', 'Unit', 'Rate', 'Service Value', 'Taxable value', '', ''], ['', '', '', '', '', '', '', '', 'Rate \nAmount\nRate', 'Amount\nRate \nAmount'], ['', 'Building Maintenance of Cement', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '1350', '1350'], ['1', 'Warehouse for period Aug 21', '998343', '', '', '', '15000', '15000', '9.00', '9.00'], ['', '', '', '', '', 'Total Amount Before tax', '', '15000', 'Total Tax Amount', '2700.00']]

df_M2 = [['State  Code  /  State  : \n24  /  Gujarat', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', 'Sap  Number  :', '', '', '5810016987', '', '', ''], ['SN \nDescription  of  Goods', 'HSN/SAC  ', '', '', '', '', '', '', '', '', ''], ['', '', '', 'Packaging  Description', '', '', 'Qty \n', 'Unit', '', 'Unit  Price', '  Totai  Value  of'], ['', '', '', '', '', '', 'Z', '', '', '', 'Supply'], ['1 \nACCMON \n60 \nSPECIAL', '38160000', 'HDPE', '', '', '', '', '', '', '', ''], ['', '', '', '', 'Bags \n25 \nKg.', '', '5.000', 'mt', '', '26,100.09', '1,500.00'], ['', '', '19600', '', 'Nos', '', '', '', '', '', ''], ['', '', '4', '', '', '', '', '', '9.00  %', '', '35,235.00'], ['-', '', '', '', '', '', 'SGST', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', ''], ['4', '', '', '', '', '', 'ccs', '', '9.00  %', '', '35,235.00'], [' \na \n. \nwal', '-', '', '', '', '', 'JO', '', '', '', ''], ['- \nfod', 'i', '', '', '', '', '', '', '', '', ''], ['ADDITIVE \nA \n2.', '', '', '', '', '', '', '', '', '', ''], ['22.5 \nKG', 'Additional  Information:', '', '', '', '', '', '', '', '', ''], ['ACCMON \n60 \nSY \n%', '', '', '', '', '', '', '', '', '', ''], ['pers \nane', 'ed', '', '', 'Total', '', '', '', '', '', ''], ['', '', '', '', '', '', '15.000', 'MT', '', '', '/ 391,500.00'], ['', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', 'xable  Value  Includes  Freight', '', '', '', '', '']]

df_M3 = [['', '', '', '', '', '', '', '', '', '', 'of  Dispatch \nPlace', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', 'me  of  Carrier', '', '', '', '', '', '', '', '', '', '', '', ''], ['Veiiicle', 'No', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', 'ai \nNo', ''], ['', '', '', '', '', '', '', '', '', '', '', 'BasisRCM: \nReverse  Charge', '', ''], ['', '', '', '', '', '', '', '', '', '', 'Payable  under \nis \nWhether  Tax', '', '', ''], ['', '', ':', '', '', '', '', '', '', '', '', '', '', ''], ['LR/RR  No', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', 'Pkg.Kgs.::', '', '', ''], ['', '', '', '', '', '', '', '', '', '', 'Average  Contents  per', '', '', ''], ['', '', '0', '', '', '', '', '', '', '', '', 'Rat√©  per  MT  ', 'Amount  Rs.', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', 'Description  of  Packages:', '', '', '', '', '', '', '', '', '', '', '', ''], [' \nNo.', '', '', '', '', '', '', '', '', '', 'ty  MT \nHSN  CODE', '', '', ''], ['', '', '', '', '', '', '', '', ':', '', '', '', '', ''], ['', 'Description', 'of  Goods', '', '', '', '', '', '', '', '', '', '231,358.90', ''], ['', '', '', '', '', '', '', '', '', '', '', '410.00 \n', '', ''], ['', '', '', '', '', '', '', '', '', '', '564.2901 \n/', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '25210090', '', '', ''], ['', '', '', 'we', '', '', '', '', '', '', '', '', '', ''], ['SF2USLS', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', 'IMESTONE-SIZE  0-30  mm', '', '', '', '', '', '', '', '', '', '', '', ''], ['si', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '/', '', '', '', '', '', '', '', '', '', ''], ['', 'BATCH  NO  -', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '231,358.90', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '5,783.97', ''], ['', 'Taxable  Value', '', '', '', '', '', '', '', '', '', '2.50% \nA,', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '5,783.97', ''], ['IN:', 'Central  GST  CGST', '', '', '', '', '', '', '', '', '', '2.50% \nl', '', ''], ['', '', '', '', '', '', '', '', '', '', 'i', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '0.16', ''], ['IN:', 'State  GST  SGST', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '242,927.00', ''], ['', 'Round  off.', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', 'Rs. \nTotal  Value  in', '', '', ''], ['', 'Total  Amount  in  Words  :  TWO  LAKH  FORTY-TWO  THOUSAND  NINE  Hi  UNDRED  TWEN  TY-SEVEN  ONLY', '', '', '', '', '', '', '', '', '', 'up', 'of \ntime \nthe \nto', ''], ['', '', '', '', '', '', '', '', '', '', '', 'taxes \nim \nincrease \nAny  Staiutory', '', ''], ['', '', '', '', '', '', '', '', '', '', 's  may  be \nextra \nbe', 'applicable.', '', ''], ['', 'TERMS    CONDITIONS', '', '', '', '', '', '', '', '', 'shall \ntaxes \nand \napply', '', '', ''], ['', '', '', 'from', 'its', 'Depots  or', '', '', 'from  Godowns  shall', '', '', '', '', ''], ['', '', 'of  goods  from', 'or \nfactory \nthe', '', '', '', '', '', '', '', '', '', ''], ['', 'the \nat \nculing', 'of  dispatch \ntime', '', '', '', '', '', '', '', '', '', '', ''], ['Prices \n1.', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', 'the \nto \nbe \nshall', 'Buyers  account.', '', '', '', '', '18%', 'shall', 'charged \nbe', '', 'the \nto \nSeller \nthe', 'Buyer  unless  otherwise', ''], ['delivery', '', '', 'at \ninterest', 'the', 'rate', 'of', '', '', '', 'other', 'by \npayable \nsum', '', ''], ['', '', 'credit \nthe', 'period  allowed,', '', '', '', '', '', '', 'any \nor \nany  counter-claim,  commission', '', '', ''], ['', 'delayed', 'beyond', '', '', '', '', '', '', 'against', '', '', '', ''], ['', 'If  the  payment  is', '', '', 'circumstances', '', 'shall', 'oe', 'adjusted', '', '', '', '', ''], ['', '', 'the \nin \nprice  mentioned', 'invoice,  under  no', '', '', '', '', '', '', '', '', '', ''], ['', 'y  The  payment  of  the', '', '', '', '', '', '', '', '', '', 'of  GST. \npayment \nadditional \ntor', '', '']]

df_S5 = [['wt', 'Particulars', '', '', '', '', ''], ['', '', '', '', '', '', 'HSN/SAC \nAmount'], ['', '', 'Other  Employement    Labour  Supply  Services', '', '', '', '998519 \n32,000.00'], ['', 'Charges  of  Providing  Manpower  of', '', '', '', '', ''], ['', 'House  Keeping  Job  at  Annexure  Building,', '', '', '', '', ''], ['', 'Mehta  House \nfor  the  Month  of  August-21', '', '', '', '', ''], ['', '', '', '', '', '', ''], ['', '', '', '', '', 'Output  SGST  9%  ', ' \n2,880.00 '], ['', '', '', '', 'Output  CGST', '  9%', '2,880.00 \n'], ['', 'ee', '', '', '', '', ''], ['', '', '', '', '', 'Total', 'ss.  37,760.00  -'], ['rAmount  Chargeable  in  words', '', '', '', '', '', ''], ['', '', '', '', '', '', 'EE  BOE'], ['', 'Indian  Rupees  Thirty  Seven  Thousand  Seven  Hundred  Sixty  Only', '', '', '', '', ''], ['', '', '', '', '', '', ' \nOrr  EX   '], ['', 'HSN/SAC', '', 'Taxable', '', '', ''], ['', '', '', '', '  Central  Tax ', '', 'State  Tax \nJ \nTotal']]

df_S2 = [[' \n-', '', 'HSN/SAC', '', '', '', '', 'TOTAL'], [' \nDescription  of  Goods  or/and  Service', '', 'o \n-', 'Rate', 'Per', 'Qty.', '', 'el'], ['', '', 'Code', '', '', '', '', 'VALUE'], ['', '', ': \nz', '', '', '', '', ''], ['', '', '', '', '', 'Loe', '', ''], ['Manpower  Supply  For  Water  Pump  Operator', '', '998519', '431.00', '', '26', '', 'o'], ['', '', '', '', '', '', '', 'c'], [' \nif  F  AND  ADMINISTRATION  CHARGE  13%', '', '', '', '', '', '', '1,457.06 \n'], [' \n', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', 'CO'], ['SERVICE \nCHARGE \nAND  PROFIT', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '703.99 \n'], [':', 'otal', '', '', '', 'i', '', '13,364.00  '], ['a,', '', 'TAXABLE  VALUE  OF  GOODS/SERVICES  ', '', '', '13,364.00', '', ''], ['jReverse  Charge    GST  oo...', '', 'Reverse  Charge  ', 'GST', '.........', '', '', ''], [' \nOther  Charges', '', '', '', '', 'A', '', ''], ['a', '', '', 'CGST    9%  Total', '', ' \n \n203.00', '', ''], ['', '', '', 'SGST  9%Total', '', ': \n1203.00', '', ''], ['an', '', '', '', '', 'Total \nNet  Amount', '', '15,770.00'], ['i \n \n \nip', '', '', '', '', '', '', ''], ['', 'EEN  THOUSAND  SEVEN  HUNDRED  SEVENTY  ONLY', '', '', '', '', '', ''], ['M/S.SHREERAJ  TRADING \nCo.', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '3'], ['', '', '', '', '', '', '', 'ase'], [' \n3  As \nKOM', '', '', '', '', '', '', '.'], ['', '', '', '', '', '', '', '']]
# df = df_tax_invoice

df_S3 = [['TAX  -  INVOICE \nU/S. \n31  READ  WITH  RULE \nM/S  SHREERAJ  TRADING  CO.', '', '', '', '', 'Pro. \n: \nB.K. \nGohil \nOffice \n: \nPranchi  Tirth \nTaluka \n:  Sutrapada \nDist \n:  GirSomnath'], ['Pin \n:  362268', '', '', '', '', ''], ['EMAIL  :- \nShreerajtradingcol1  gmail.com \nPAN  No  :-  ABZPG7454Q  Mo  :  99798  93399 \nGSTIN  NO  :-  24ABZPG7454Q1ZN', '', '', '', '', 'Gujarat'], ['Recipient  Details', '', 'TAX  INVOICE  NO.', '', '20', ''], ['Gujarat  Sidhee  Cement  Ltd.', '', 'TAX  INVOICE  DATE', '', '25-08-2021', ''], ['Address:-Sidheegram,  Veraval-Kodinar  Highway, \nPost:-  Sidheegram  -  362276,  Morasa \nTa \n-  Sutrapada,  Dist:- \nGSTIN  NO  :-  24AAACG8057G1ZP \nPlace  of  Supply  :-  SIDHEEGRAM  -  362  276', 'Gir  Somnath,  State  -  Gujarat.  CODE  : \n24', 'Address  of  Delivery  Compulsory \nif  recipient  Un  Registered  of \nother \nState   \ninvoice  Value  Rs.50000.00 \nor  more', '', '', ''], ['WORKORDER  NO:-  SGJPO0005352122-REVENUE', '', 'State  Code  Compulsory  if  recipient \nUn  Registered  of  other  State \n \nInvoice', '', '', ''], ['WORKORDER  DATE  :- \n12  AUG  2021', '', '', '', '', ''], ['Category  :  Manpower  Recruitment/Supply  Agency  Service', '', 'Value  Rs.', '', '', ''], ['Job  :  Supply  of  operator  and  Helper  for  RowMaterial  Handling  Works', '', 'State  Code  Compulsory  if  recipient \nif  recipient  Un  Registered  of  other', '', '', ''], ['', 'Period \n:- \n01/07/2021 \nTO \n31/07/2021', 'State \n \nor  more', 'Invoice  Value  Rs.50000.00', '', ''], ['', '', 'Tax  is  payable  on  reverse  Charge', '', 'YES  OR  NO', 'NO'], ['Sr. \nNo.', '. \nDescription  of  Goods  or/and  Service \n. \nh', 'HSN/SAC \nCode', 'Rate  Per', 'ty. \nay', 'TOTAL'], ['', '', '', '', '', 'VALUE'], ['1 \n2', 'Raw \nMatar \n: \n \n  Extra  Supply  of  Man  power  for \nRaw \nMaterial  Loading  Unloading \nworks \nOPERATOR \n SERVICE \nCHARGE \nAND  PROFIT', '998519', '609.00', '70', '42,630.00 \n3,710.00'], ['', 'TOTAL', '', '', '', '46,340.00'], ['WORKORDER  NO:-  SGJPO00005352122  REVENUE', '', '', '', '', ''], ['WORKORDER  DATE  :- \n12  AUG  2021', '', '', '', '', ''], ['', '', '', '', '', ''], ['1 \n2', 'Extra  Supply  of  Man  power  for  Raw  Material  Loading \nUnloading  works \nDRIVER \n SERVICE \nCHARGE \nAND  PROFIT', '998519', '505.00', '53 \n4 \nNS', '26,765.00 \nys \n1,908.00'], ['', 'TOTAL', '', '', '1.5', 'N  JW \n28673.00'], ['', '', '', '', '% \nYX', '75,013.00'], ['oR  2  Clire  a \n4 \nVOM  Rii \nTAXABLE  VALUE  OF  GOODS/SERVICES  ', '', '', '', '75,03.00', ''], ['Reverse  Charge    GST...........2  \nSeveutry \nFypve \n. \nReverse  Charge    GST.........', '', '', '', '', ''], ['Add  :  Other  Charges \nthoadey \nFlupjvex', '', '', '', '', ''], ['OVW4 \nCGST    9%  Total \n', '', '', '', '6,751.00', ''], ['y \nSGST    9%  Total  ', '', '', '', '6,751.00', ''], ['fa \nBio. \nTotal \nNet  Amount', '', '', '', '', '88,515.00'], ['E. \n \nO.E.  Rupees  EIGHTY  EIGHT  THOUSAND  FIVE  HUNDRED  FIFTEEN  ONLY \n \nQe  \nrh \n \n450 \nMary 4- \nF \nLoe \noY \n9 \nom \nae \nM/S.  SHREERAJ \nADING \nCo. \nFor,  M/S  Shreeraj  Trading  Co. \nWE  foe', '', '', '', '', ''], ['', '', '', '', '', ''], ['', '', '', '', '', '']]
# df = df_service_with_activity
df = df_S5
df = cleaning_data(df)
df = pd.DataFrame(df)
df = cleaning_data2(df)
df = pd.DataFrame(df)
print('******************************************************************************************* After Cleaning ******************************************************************************')
print(df)
print('******************************************************************************************* After Cleaning ******************************************************************************')

